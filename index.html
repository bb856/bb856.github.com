<h1>ActiveX control enumeration test</h1>

<span id=sandbox>
</span>

<p>

<b>Results (now trying: <span id=status>n/a</span>):</b><br>
<div id=output>
</div>

<script>
var  ctrls = [
  ["007", "test dummy", false ],
  ["00000300-0000-0000-C000-000000000046","StdOleLink (embedded OLE object - Known Related to CVE-2017-0199, CVE-2017-8570, CVE-2017-8759 or CVE-2018-8174)",false],
  ["00000303-0000-0000-C000-000000000046","File Moniker (may trigger CVE-2017-0199 or CVE-2017-8570)",false],
  ["00000304-0000-0000-C000-000000000046","Item Moniker",false],
  ["00000305-0000-0000-C000-000000000046","Anti Moniker",false],
  ["00000306-0000-0000-C000-000000000046","Pointer Moniker",false],
  ["00000308-0000-0000-C000-000000000046","Packager Moniker",false],
  ["00000309-0000-0000-C000-000000000046","Composite Moniker (may trigger CVE-2017-8570)",false],
  ["0000031a-0000-0000-C000-000000000046","Class Moniker",false],
  ["00000535-0000-0010-8000-00AA006D2EA4","ADODB.RecordSet (may trigger CVE-2015-0097)",false],
  ["0002034c-0000-0000-C000-000000000046","OutlookAttachMoniker",false],
  ["0002034e-0000-0000-C000-000000000046","OutlookMessageMoniker",false],
  ["00020810-0000-0000-C000-000000000046","Microsoft Excel.Sheet.5",false],
  ["00020811-0000-0000-C000-000000000046","Microsoft Excel.Chart.5",false],
  ["00020820-0000-0000-C000-000000000046","Microsoft Microsoft Excel 97-2003 Worksheet (Excel.Sheet.8)",false],
  ["00020821-0000-0000-C000-000000000046","Microsoft Excel.Chart.8",false],
  ["00020830-0000-0000-C000-000000000046","Microsoft Excel.Sheet.12",false],
  ["00020832-0000-0000-C000-000000000046","Microsoft Excel sheet with macro enabled (Excel.SheetMacroEnabled.12)",false],
  ["00020833-0000-0000-C000-000000000046","Microsoft Excel binary sheet with macro enabled (Excel.SheetBinaryMacroEnabled.12)",false],
  ["00020900-0000-0000-C000-000000000046","Microsoft Word 6.0-7.0 Document (Word.Document.6)",false],
  ["00020906-0000-0000-C000-000000000046","Microsoft Word 97-2003 Document (Word.Document.8)",false],
  ["00020C01-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["00021401-0000-0000-C000-000000000046","Windows LNK Shortcut file', # ref: https://github.com/libyal/liblnk/blob/master/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc
  ["00021700-0000-0000-C000-000000000046","Microsoft Equation 2.0 (Known Related to CVE-2017-11882 or CVE-2018-0802)",false],
  ["00022601-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["00022602-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["00022603-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["0002CE02-0000-0000-C000-000000000046","Microsoft Equation 3.0 (Known Related to CVE-2017-11882 or CVE-2018-0802)",false],
  ["0002CE03-0000-0000-C000-000000000046","MathType Equation Object",false],
  ["0003000B-0000-0000-C000-000000000046","Microsoft Equation (Known Related to CVE-2017-11882 or CVE-2018-0802)",false],
  ["0003000C-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["0003000D-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["0003000E-0000-0000-C000-000000000046","OLE Package Object (may contain and run any file)",false],
  ["0004A6B0-0000-0000-C000-000000000046","Microsoft Equation 2.0 (Known Related to CVE-2017-11882 or CVE-2018-0802)', # TODO: to be confirmed
  ["048EB43E-2059-422F-95E0-557DA96038AF","Microsoft Powerpoint.Slide.12",false],
  ["05741520-C4EB-440A-AC3F-9643BBC9F847","otkloadr.WRLoader (can be used to bypass ASLR after triggering an exploit)",false],
  ["06290BD2-48AA-11D2-8432-006008C3FBFC","Factory bindable using IPersistMoniker (scripletfile)",false],
  ["06290BD3-48AA-11D2-8432-006008C3FBFC","Script Moniker, aka Moniker to a Windows Script Component (may trigger CVE-2017-0199)",false],
  ["0CF774D0-F077-11D1-B1BC-00C04F86C324","scrrun.dll - HTML File Host Encode Object (ProgID: HTML.HostEncode)",false],
  ["0D43FE01-F093-11CF-8940-00A0C9054228","scrrun.dll - FileSystem Object (ProgID: Scripting.FileSystemObject)",false],
  ["0E59F1D5-1FBE-11D0-8FF2-00A0D10038BC","MSScriptControl.ScriptControl (may trigger CVE-2015-0097)",false],
  ["1461A561-24E8-4BA3-8D4A-FFEEF980556B","BCSAddin.Connect (potential exploit CVE-2016-0042 / MS16-014)",false],
  ["14CE31DC-ABC2-484C-B061-CF3416AED8FF","Loads WUAEXT.DLL (Known Related to CVE-2015-6128)",false],
  ["1D8A9B47-3A28-4CE2-8A4B-BD34E45BCEEB","UPnP.DescriptionDocument",false],
  ["1EFB6596-857C-11D1-B16A-00C0F0283628","MSCOMCTL.TabStrip (may trigger CVE-2012-1856, CVE-2013-3906 - often used for heap spray)",false],
  ["233C1507-6A77-46A4-9443-F871F945D258","Shockwave Control Objects",false],
  ["23CE100B-1390-49D6-BA00-F17D3AEE149C","UmOutlookAddin.UmEvmCtrl (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["3018609E-CDBC-47E8-A255-809D46BAA319","SSCE DropTable Listener Object (can be used to bypass ASLR after triggering an exploit)",false],
  ["3050F4D8-98B5-11CF-BB82-00AA00BDCE0B","HTML Application (may trigger CVE-2017-0199)",false],
  ["33BD73C2-7BB4-48F4-8DBC-82B8B313AE16","osf.SandboxManager (Known Related To CVE-2015-1770)",false],
  ["33FD0563-D81A-4393-83CC-0195B1DA2F91","UPnP.DescriptionDocumentEx",false],
  ["394C052E-B830-11D0-9A86-00C04FD8DBF7","Loads ELSEXT.DLL (Known Related to CVE-2015-6128)",false],
  ["3BA59FA5-41BF-4820-98E4-04645A806698","osf.SandboxContent (Known Related To CVE-2015-1770)",false],
  ["41B9BE05-B3AF-460C-BF0B-2CDD44A093B1","Search.XmlContentFilter (potential exploit document CVE TODO)",false],
  ["4315D437-5B8C-11D0-BD3B-00A0C911CE86","Device Moniker (Known Related to CVE-2016-0015)",false],
  ["44F9A03B-A3EC-4F3B-9364-08E0007F21DF","Control.TaskSymbol (Known Related to CVE-2015-1642 & CVE-2015-2424)",false],
  ["46E31370-3F7A-11CE-BED6-00AA00611080","Forms.MultiPage",false],
  ["4C599241-6926-101B-9992-00000B65C6F9","Forms.Image (may trigger CVE-2015-2424)",false],
  ["4D3263E4-CAB7-11D2-802A-0080C703929C","AutoCAD 2000-2002 Document",false],
  ["5E4405B0-5374-11CE-8E71-0020AF04B1D7","AutoCAD R14 Document",false],
  ["64818D10-4F9B-11CF-86EA-00AA00B929E8","Microsoft Powerpoint.Show.8",false],
  ["64818D11-4F9B-11CF-86EA-00AA00B929E8","Microsoft Powerpoint.Slide.8",false],
  ["66833FE6-8583-11D1-B16A-00C0F0283628","MSCOMCTL.Toolbar (Known Related to CVE-2012-0158 & CVE-2012-1856)",false],
  ["6A221957-2D85-42A7-8E19-BE33950D1DEB","AutoCAD 2013 Document",false],
  ["6AD4AE40-2FF1-4D88-B27A-F76FC7B40440","BCSAddin.ManageSolutionHelper (potential exploit CVE-2016-0042 / MS16-014)",false],
  ["6E182020-F460-11CE-9BCD-00AA00608E01","Forms.Frame",false],
  ["799ED9EA-FB5E-11D1-B7D6-00C04FC2AAE2","Microsoft.VbaAddin (Known Related to CVE-2016-0042)",false],
  ["79EAC9D0-BAF9-11CE-8C82-00AA004BA90B","StdHlink",false],
  ["79EAC9D1-BAF9-11CE-8C82-00AA004BA90B","StdHlinkBrowseContext",false],
  ["79EAC9E0-BAF9-11CE-8C82-00AA004BA90B","URL Moniker (may trigger CVE-2017-0199, CVE-2017-8570, or CVE-2018-8174)",false],
  ["79EAC9E2-BAF9-11CE-8C82-00AA004BA90B","(http:) Asychronous Pluggable Protocol Handler",false],
  ["79EAC9E3-BAF9-11CE-8C82-00AA004BA90B","(ftp:) Asychronous Pluggable Protocol Handler",false],
  ["79EAC9E5-BAF9-11CE-8C82-00AA004BA90B","(https:) Asychronous Pluggable Protocol Handler",false],
  ["79EAC9E6-BAF9-11CE-8C82-00AA004BA90B","(mk:) Asychronous Pluggable Protocol Handler",false],
  ["79EAC9E7-BAF9-11CE-8C82-00AA004BA90B","(file:, local:) Asychronous Pluggable Protocol Handler",false],
  ["7AABBB95-79BE-4C0F-8024-EB6AF271231C","AutoCAD 2007-2009 Document",false],
  ["85131630-480C-11D2-B1F9-00C04F86C324","scrrun.dll - JS File Host Encode Object (ProgID: JSFile.HostEncode)",false],
  ["85131631-480C-11D2-B1F9-00C04F86C324","scrrun.dll - VBS File Host Encode Object (ProgID: VBSFile.HostEncode)",false],
  ["8627E73B-B5AA-4643-A3B0-570EDA17E3E7","UmOutlookAddin.ButtonBar (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["88D969E5-F192-11D4-A65F-0040963251E5","Msxml2.DOMDocument.5.0",false],
  ["88D969E9-F192-11D4-A65F-0040963251E5","Msxml2.DSOControl.5.0",false],
  ["88D969E6-F192-11D4-A65F-0040963251E5","Msxml2.FreeThreadedDOMDocument.5.0",false],
  ["88D969F5-F192-11D4-A65F-0040963251E5","Msxml2.MXDigitalSignature.5.0",false],
  ["88D969F0-F192-11D4-A65F-0040963251E5","Msxml2.MXHTMLWriter.5.0",false],
  ["88D969F1-F192-11D4-A65F-0040963251E5","Msxml2.MXNamespaceManager.5.0",false],
  ["88D969EF-F192-11D4-A65F-0040963251E5","Msxml2.MXXMLWriter.5.0",false],
  ["88D969EE-F192-11D4-A65F-0040963251E5","Msxml2.SAXAttributes.5.0",false],
  ["88D969EC-8B8B-4C3D-859E-AF6CD158BE0F","Msxml2.SAXXMLReader.5.0",false],
  ["88D969EB-F192-11D4-A65F-0040963251E5","Msxml2.ServerXMLHTTP.5.0",false],
  ["88D969EA-F192-11D4-A65F-0040963251E5","Msxml2.XMLHTTP.5.0",false],
  ["88D969E7-F192-11D4-A65F-0040963251E5","Msxml2.XMLSchemaCache.5.0",false],
  ["88D969E8-F192-11D4-A65F-0040963251E5","Msxml2.XSLTemplate.5.0",false],
  ["8E75D913-3D21-11D2-85C4-080009A0C626","AutoCAD 2004-2006 Document",false],
  ["9181DC5F-E07D-418A-ACA6-8EEA1ECB8E9E","MSCOMCTL.TreeCtrl (may trigger CVE-2012-0158)",false],
  ["975797FC-4E2A-11D0-B702-00C04FD8DBF7","Loads ELSEXT.DLL (Known Related to CVE-2015-6128)",false],
  ["978C9E23-D4B0-11CE-BF2D-00AA003F40D0","Microsoft Forms 2.0 Label (Forms.Label.1)",false],
  ["996BF5E0-8044-4650-ADEB-0B013914E99C","MSCOMCTL.ListViewCtrl (may trigger CVE-2012-0158)",false],
  ["A08A033D-1A75-4AB6-A166-EAD02F547959","otkloadr WRAssembly Object (can be used to bypass ASLR after triggering an exploit)",false],
  ["B54F3741-5B07-11CF-A4B0-00AA004A55E8","vbscript.dll - VB Script Language (ProgID: VBS, VBScript)",false],
  ["B801CA65-A1FC-11D0-85AD-444553540000","Adobe Acrobat Document - PDF file",false],
  ["BDD1F04B-858B-11D1-B16A-00C0F0283628","MSCOMCTL.ListViewCtrl (may trigger CVE-2012-0158)",false],
  ["C08AFD90-F2A1-11D1-8455-00A0C91F3880","ShellBrowserWindow",false],
  ["C62A69F0-16DC-11CE-9E98-00AA00574A4F","Forms.Form",false],
  ["C74190B6-8589-11D1-B16A-00C0F0283628","MSCOMCTL.TreeCtrl (may trigger CVE-2012-0158)",false],
  ["CCD068CD-1260-4AEA-B040-A87974EB3AEF","UmOutlookAddin.RoomsCTP (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["CDDBCC7C-BE18-4A58-9CBF-D62A012272CE","osf.Sandbox (Known Related To CVE-2015-1770)",false],
  ["CDF1C8AA-2D25-43C7-8AFE-01F73A3C66DA","UmOutlookAddin.InspectorContext (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["CF4F55F4-8F87-4D47-80BB-5808164BB3F8","Microsoft Powerpoint.Show.12",false],
  ["D27CDB6E-AE6D-11CF-96B8-444553540000","Shockwave Flash Object (may trigger many CVEs)",false],
  ["D27CDB70-AE6D-11CF-96B8-444553540000","Shockwave Flash Object (may trigger many CVEs)",false],
  ["D50FED35-0A08-4B17-B3E0-A8DD0EDE375D","UmOutlookAddin.PlayOnPhoneDlg (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["D7053240-CE69-11CD-A777-00DD01143C57","Microsoft Forms 2.0 CommandButton",false],
  ["D70E31AD-2614-49F2-B0FC-ACA781D81F3E","AutoCAD 2010-2012 Document",false],
  ["D93CE8B5-3BF8-462C-A03F-DED2730078BA","Loads WUAEXT.DLL (Known Related to CVE-2015-6128)",false],
  ["DD9DA666-8594-11D1-B16A-00C0F0283628","MSCOMCTL.ImageComboCtrl (may trigger CVE-2014-1761)",false],
  ["DFEAF541-F3E1-4c24-ACAC-99C30715084A","Silverlight Objects",false],
  ["E5CA59F5-57C4-4DD8-9BD6-1DEEEDD27AF4","InkEd.InkEdit",false],
  ["E8CC4CBE-FDFF-11D0-B865-00A0C9081C1D","MSDAORA.1 (potential exploit CVE TODO)', # TODO
  ["E8CC4CBF-FDFF-11D0-B865-00A0C9081C1D","Loads OCI.DLL (Known Related to CVE-2015-6128)",false],
  ["ECABAFC6-7F19-11D2-978E-0000F8757E2A","New Moniker",false],
  ["ECABAFC9-7F19-11D2-978E-0000F8757E2A","Loads MQRT.DLL (Known Related to CVE-2015-6128)",false],
  ["ECABB0C7-7F19-11D2-978E-0000F8757E2A","SOAP Moniker (may trigger CVE-2017-8759)",false],
  ["ECF44975-786E-462F-B02A-CBCCB1A2C4A2","UmOutlookAddin.FormRegionContext (potential exploit document CVE-2016-0042 / MS16-014)",false],
  ["F20DA720-C02F-11CE-927B-0800095AE340","OLE Package Object (may contain and run any file)",false],
  ["F414C260-6AC0-11CF-B6D1-00AA00BBBB58","jscript.dll - JScript Language (ProgID: ECMAScript, JavaScript, JScript, LiveScript)",false],
  ["F4754C9B-64F5-4B40-8AF4-679732AC0607","Microsoft Word Document (Word.Document.12)",false],
  ["F959DBBB-3867-41F2-8E5F-3B8BEFAA81B3","UmOutlookAddin.FormRegionAddin (potential exploit document CVE-2016-0042 / MS16-014)",false]
];

var cur = 0;
var res_ok;
var res_err;
var tout;
var got_new = 0;
var pass = 1;

function update_results() {
  var t = '';

  for (i=0;i<ctrls.length;i++) 
    if (ctrls[i][2] == true)
      t += '<li> ' + ctrls[i][1] + ' (' + ctrls[i][0] + ') is supported.\n';

  document.getElementById('output').innerHTML = t;
}


function do_next() {
  res_ok = false;
  res_err = false;
  
  document.getElementById('status').innerHTML = ctrls[cur][1] + ':' + pass;

  tout = setTimeout('cont(2)',4000);
  
  document.getElementById('sandbox').innerHTML = '<object classid="clsid:' + ctrls[cur][0] + '" width=200 height=200 style="background-color: teal"' +
                                                 'onload="cont(true)" onerror="cont(false)"></object>';

}

function cont(res) {

  if (tout == null) return;
  clearTimeout(tout);
  tout = null;

  if (res) {

    if (cur == 0) {
      document.getElementById('output').innerHTML += '<li> <font color=red><b> Direct clsid: ActiveX access is probably not supported, bailing out.'
      return;
    }

    if (ctrls[cur][2] != true) {
      ctrls[cur][2] = true;
      update_results();
      got_new++;
    }

  }


  while (++cur < ctrls.length && ctrls[cur][2] == true);

  if (cur < ctrls.length) {

    setTimeout('do_next()',1);

  } else {


    // We had new findings. Let's do another pass.
    if (got_new > 0) {
      cur = 0;
      got_new = 0;
      pass++;
      do_next();
    } else
      document.getElementById('status').innerHTML = 'ALL DONE - ' + pass + ' passes';

  }
  
}

do_next();

</script>
